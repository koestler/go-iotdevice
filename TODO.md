# Todos
- redo / check homeassistant integration using mqtt realtime messages
- mqttDevice:
 - separate structure and values in different topics
 - allow filter for realtime message by register / category (like hassDiscovery)
 - implement command topic / handling of relays
 - implement available / unavailable messages correctly
   - when receiver mqtt connection closed,
   - when sender mqtt connection closed mqtt connection closed
   - when device is disconnected (modbus / http etc.)
- hassDiscovery:
  - use multiple availability topics to also make device unavailable when its disconnected
- come up with a generic register filter usable for mqtt messages, hass discovery, views etc.
- use this filter to replace the RealtimeViaMqttClient and TelemetryViaMqttClient; if not possible, add StructureViaMqttClient
- mqtt: recheck default topics
  - do the make sense or shall they be changed?
  - compare with other implementation (hass, tasmota etc.)
  - remove go-iotdevice? (seems quite obsolete to me now)
- registerDB: should it check if a register is changed and only send the update if it is?
- mqttDevice: implement available / unavailable messages
- hass discovery:
  - devices: protect registers variable from multiple access
  - add ready listener to inform hass that the registers array is populated
